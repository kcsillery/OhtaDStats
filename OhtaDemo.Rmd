---
title: "OhtaDStat Demo"
author: "Paul F. Petrowski"
date: "August 14, 2018"
output: html_document
---

## Setup and Data Import
If you haven't already, install the package using install.packages("ohtadstat")
```{r}
library(ohtadstats)
data(miyashita_langley_data)
```

## Computation of Ohta's D Statistics for a single Pair of Markers
If you are interested in computing Ohta's D statistics for a single pair of loci, you can do so by calling the dstat function.
```{r}
dstat(index = c(28,41), data_set = miyashita_langley_data, tot_maf = 0.05, pop_maf = 0.01)
```

The two loci to be evaluated are passed to the index argument as a two element vector.


## Computation of Ohta's D statistics for a small dataset.
If you have a small dataset and would like to compute Ohta's D statistics for each possible pair of loci, use the dwrapper function.
```{r}
dwrap_results <- dwrapper(data_set = miyashita_langley_data, tot_maf = 0.00, pop_maf = 0.00)
summary(dwrap_results)
dwrap_results$dp2is_mat[1:5,1:5]
```

Note that the dwrapper algorithm is big O N-squared. The amount of time required to analyze a dataset with dwrapper will increase dramatically with the number of loci. For this reason we recommend not using it except for on datasets less than one thousand loci.
Anything larger than that should be evaluated using the dparallel workflow as described below.

## Visualization of Results using dheatmap
The dheatmap function makes it easy to visualize results from dwrapper. Just pass it a matrix object.

```{r}
map <- dheatmap(d_matrix = dwrap_results$dp2is_mat)
map
```
